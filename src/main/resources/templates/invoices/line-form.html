<!DOCTYPE html>
<html lang="it" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout :: layout(~{::content})}">
<body>
<div th:fragment="content">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h4 mb-0">Modifica riga fattura <span th:text="${invoice.number}"></span></h1>
        <a class="btn btn-outline-secondary" th:href="@{/invoices/{id}(id=${invoice.id})}">Torna al dettaglio</a>
    </div>

    <form th:action="@{/invoices/{id}/lines/{lineId}(id=${invoice.id}, lineId=${line.id})}" th:object="${line}" method="post" class="row g-3">
        <div class="col-md-6">
            <label class="form-label" for="description">Descrizione</label>
            <input type="text" class="form-control" id="description" th:field="*{description}" required>
            <div class="invalid-feedback d-block" th:if="${#fields.hasErrors('description')}" th:errors="*{description}"></div>
        </div>
        <div class="col-md-3">
            <label class="form-label" for="netAmount">Imponibile</label>
            <input type="number" step="0.01" min="0.01" class="form-control" id="netAmount" th:field="*{netAmount}" required>
            <div class="invalid-feedback d-block" th:if="${#fields.hasErrors('netAmount')}" th:errors="*{netAmount}"></div>
        </div>
        <div class="col-md-3">
            <label class="form-label" for="vatCode">Codice IVA</label>
            <select class="form-select" id="vatCode" th:field="*{vatCode.id}">
                <option th:value="">Nessuno</option>
                <option th:each="v : ${vatCodes}" th:value="${v.id}" th:text="${v.code + ' (' + (v.rate != null ? v.rate + '%' : 'n.d.') + ')'}"></option>
            </select>
        </div>
        <div class="col-md-4">
            <label class="form-label" for="account">Conto</label>
            <select class="form-select" id="account" th:field="*{account.id}">
                <option th:value="">Nessuno</option>
                <option th:each="a : ${accounts}" th:value="${a.id}" th:text="${a.code + ' - ' + a.description}"></option>
            </select>
        </div>
        <div class="col-md-4">
            <label class="form-label" for="withholdingType">Ritenuta</label>
            <select class="form-select" id="withholdingType" th:field="*{withholdingType.id}">
                <option th:value="">Nessuna</option>
                <option th:each="w : ${withholdingTypes}" th:value="${w.id}" th:text="${w.code + ' (' + (w.rate != null ? w.rate + '%' : 'n.d.') + ')'}"></option>
            </select>
        </div>
        <div class="col-12 d-flex justify-content-end gap-2">
            <a class="btn btn-outline-secondary" th:href="@{/invoices/{id}(id=${invoice.id})}">Annulla</a>
            <button type="submit" class="btn btn-primary">Salva</button>
        </div>
    </form>
</div>
</body>
</html>